###
# Core Settings
###

# Set terminal type to support 256 colors
set -g default-terminal "screen-256color"
# Enable true color (RGB) support for modern terminals
set -ag terminal-overrides ",xterm-256color:RGB"

# Enable mouse support for scrolling, pane selection, and resizing
set -g mouse on

# Change prefix key from default Ctrl+b to Ctrl+a (easier to reach)
set -g prefix C-a

###
# Numbering Windows and Panes
###

# Sort sessions alphabetically when choosing from session list
bind s choose-tree -Zs -O name

# Start window numbering at 1 instead of 0 (more intuitive for keyboard)
set -g base-index 1
# Start pane numbering at 1 instead of 0
setw -g pane-base-index 1

# Automatically renumber windows when one is closed (no gaps in numbering)
set -g renumber-windows on

###
# New keyboard shortcuts
###

# Source the Tmux Config File with prefix + r
unbind r
bind r source-file ~/.config/tmux/tmux.conf \; display-message "âš¡ Config reloaded!"

# Split window horizontally with prefix + '\' or '|' (creates panes side by side)
unbind '%'
bind-key "|" split-window -h -c "#{pane_current_path}"
bind-key "\\" split-window -fh -c "#{pane_current_path}"

# Split window vertically with prefix + '-' or '_'
unbind '"'
bind-key "-" split-window -v -c "#{pane_current_path}"
bind-key "_" split-window -fv -c "#{pane_current_path}"

# Toggle between current and last window with prefix + Space
bind Space last-window

# Resize panes with vim-style hjkl keys (repeatable with -r flag)
# prefix + j: resize pane down by 5 rows
bind -r j resize-pane -D 5
# prefix + k: resize pane up by 5 rows
bind -r k resize-pane -U 5
# prefix + l: resize pane right by 5 columns
bind -r l resize-pane -R 5
# prefix + h: resize pane left by 5 columns
bind -r h resize-pane -L 5

# Toggle pane zoom (maximize/restore) with prefix + m
bind -r m resize-pane -Z

###
# Copy Mode (Vi-style)
###

# Use vim keybindings in copy mode
set-window-option -g mode-keys vi

# Start visual selection with 'v' in copy mode (like vim visual mode)
bind-key -T copy-mode-vi 'v' send -X begin-selection
# Copy selected text with 'y' in copy mode (like vim yank)
bind-key -T copy-mode-vi 'y' send -X copy-selection

# Disable automatic copy on mouse drag end (prevents unwanted copies)
unbind -T copy-mode-vi MouseDragEnd1Pane

###
# Plugins
###

# Set custom path for tmux plugin manager (follows XDG standard)
set-environment -g TMUX_PLUGIN_MANAGER_PATH "$HOME/.config/tmux/plugins"

# TPM - Tmux Plugin Manager (required for all other plugins)
set -g @plugin 'tmux-plugins/tpm'

# Sensible defaults for tmux (reasonable base configuration)
set -g @plugin 'tmux-plugins/tmux-sensible'

# Session persistence (save/restore tmux sessions across reboots)
set -g @plugin 'tmux-plugins/tmux-resurrect'
# Automatic session save/restore (works with resurrect)
set -g @plugin 'tmux-plugins/tmux-continuum'
# Enhanced session management (additional key bindings for sessions)
set -g @plugin 'tmux-plugins/tmux-sessionist'

# System clipboard integration (copy to OS clipboard)
set -g @plugin 'tmux-plugins/tmux-yank'

# Seamless navigation between tmux panes and vim splits
set -g @plugin 'christoomey/vim-tmux-navigator'

###
# UI Theme
###

# Nord color scheme for tmux status bar
set -g @plugin 'nordtheme/tmux'

# Alternative: Catppuccin theme (commented out)
# set -g @plugin 'catppuccin/tmux'

###
# Plugin Configuration
###

# Save pane contents when restoring sessions (resurrect feature)
set -g @resurrect-capture-pane-contents 'on'
# Automatically restore last saved session on tmux start
set -g @continuum-restore 'on'

# Initialize TMUX Plugin Manager (must be at the very bottom)
# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
# Press prefix + I to install plugins
# Press prefix + U to update plugins
# Press prefix + alt + u to uninstall plugins
run '$TMUX_PLUGIN_MANAGER_PATH/tpm/tpm'
